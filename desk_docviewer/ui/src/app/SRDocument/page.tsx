"use client";

import { useRenderingContext } from "@/components/controls/RenderingContext";
import { getData } from "@/utils/tauriAPI";
import { useAsync } from "react-use";
import Inventory from "./Inventory";
import Last from "./Last";
import Powers from "./Powers";
import Summary from "./Summary";
import { SRCharacter, parseCharacter } from "./character";

export default function Home() {
  const { dataFile, resolutionDir } = useRenderingContext();

  /* const { value } = useAsync(async () => {
    if (!dataFile || !resolutionDir) {
      return;
    }
    return await getData<SRCharacter>(dataFile, resolutionDir, parseCharacter);
  }, [dataFile, resolutionDir]);

  const images = value?.[1];
  const json = value?.[0];

  if (!json) {
    return null;
  } */

  const mocked = JSON.parse(mockedJson);

  return (
    <>
      <Summary char={mocked} images={/* images */ {}} />
      {/* <Inventory char={char} />
      <Powers char={char} />
      <Last char={char} images={images} /> */}
    </>
  );
}

const mockedJson =
  '{"name":"Shrimp","tags":{"ZYaL1ACjTT":"humain","ag8fSYA2Qt":"technorigger","tpogDi1bJn":"13 ans"},"knowledges":{"Q5JrEtwnZ3":"Drônes","kz28E81osr":"Jeux tridéos","yLlYFOpzss":"Séries tridéos"},"identities":{"68qpOer6BG":{"name":"Laurence Guinvite","price":10000,"nuyens":1710,"quality":4,"lifestyle":{"name":"squatteur","price":100},"licences":{"SFfFFzxODQ":{"name":"Concierge de chantier","price":800,"quality":4}}},"bwHl4EsabT":{"contacts":{"KShC8OoPYa":{"name":"Terrance","loyalty":3,"connection":2,"description":"Ouvrier de casse militaire d\'ARES"},"VtMH8eGMvx":{"name":"D-Boss","loyalty":4,"connection":4,"description":"Decker fan de complot"}}}},"stats":{"con":2,"con_mod":0,"agi":4,"agi_mod":0,"rea":2,"rea_mod":0,"for":1,"for_mod":0,"vol":4,"vol_mod":0,"log":6,"log_mod":0,"int":4,"int_mod":0,"cha":2,"cha_mod":0,"ess":6,"edge":4,"resist_phy":{"value":2,"metas":["con"]},"resist_ment":{"value":4,"metas":["vol"]},"def_phy":{"value":6,"metas":["rea","int"]},"def_ment":{"value":8,"metas":["vol","int"]},"init_dice":1,"init_base":{"value":6,"metas":["rea","int"]},"action_maj":1,"action_min":2,"hit_phy":9,"hit_stun":10,"hit_over":2,"heal":{"value":6,"metas":["con","vol"]},"resist_drain":{"value":3,"metas":["vol"]},"res":7,"submersion":1,"firewall":4,"traitement":6,"corruption":4,"attaque":2},"skills":{"athlétisme":{"score":3},"combat_rapproché":{"score":1},"furtivité":{"score":1},"ingénierie":{"score":6,"specializations":{"SxnIBokIuY":"Artillerie"}},"perception":{"score":1},"pilotage":{"score":6,"specializations":{"e8clD4sbjD":"Appareils aux sols"}},"technomancie":{"score":6,"specializations":{"IQOIkCYfaf":"Compilation"},"masterizations":{"zBFsdw6b3M":"Inscription"}},"électronique":{"score":4}},"traits":{"Peur_du_pilotage_automatique":{"description":"__D3__ lorsque vous laissez vos machines en pilote automatique."},"Réseau_vivant":{"description":"Utlisez votre persona incarné comme noeud PAN."},"ami_des_sprites":{"description":"__A1__ lorsque vous compilez ou inscrivez un sprite machine."},"bricoleur_prévoyant":{"description":"__A1__ lorsque vous utilisez une machine que vous avez bricolé."},"paralysie_du_combat":{"description":"Au premier round, vous ne pouvez pas vous déplacer et vous jouez en dernier."},"rhinite_chronique":{"description":"Vous éternuez souvent. __D1__ lors des tests de discrétion."}},"powers":{"extraction_simsens":{"description":"Vous décompilez votre sprite pour créer un fichier de données simsens. Pour chaque __SN__, ajoutez 1 à la qualité du fichier. Rajoutez __A1__ pour chaque ancienneté du sprite (3 jours / 10 jours / 20 jours)."},"lecture_simsens":{"description":"Vous pouvez lire un fichier de donnée simsens."},"middleware":{"major":1,"minor":0,"maintained":true,"description":"Vous mobilisez un sprite pour créer un stream sensoriel interconnectant vos machines et appareils. Vous percevez alors votre environnement sous plusieurs perspectives et pilotez facilement plusieurs machines. Pour chaque Puiss. du sprite, rajoutez une 1h à l\'effet ou +1d6 à vos tests de perception. A la fin de l\'effet, le sprite est décompilé."}},"actions_common":{"accélérer":{"major":0,"minor":1,"description":"Accélérez un véhicule ou un drône. (une fois par tour)"},"ajuster":{"major":0,"minor":1,"description":"Gagner 1d6 pour votre attaque suivante"},"attaque_cruelle":{"major":1,"minor":0,"description":"Vos __SN__ permettent d\'infliger un effet de statut déterminé avec le MJ. Vous subissez __D1__ sur votre attaque."},"attaque_handicapante":{"major":1,"minor":0,"description":"Vous attaquez mais n\'infligez que les dégats de base de l\'arme. Vos __SN__ permettent d\'infliger un effet de statut déterminé avec le MJ."},"attaque_multiple":{"major":1,"minor":0,"description":"Faites plusieurs attaques sur une ou plusieurs cibles, en répartissant votre test équitablement entre toutes. Vous pouvez subir __D3__ pour utilisez votre réserve entière sur chaque cible."},"bloquer":{"major":0,"minor":1,"reaction":true,"description":"Ajoutez Combat rapproché à votre test de défense pour bloquer un coup."},"changer_de_mode":{"major":0,"minor":1,"description":"null"},"charger_attaquer":{"major":1,"minor":1,"description":"Faites votre déplacement (au moins 5 mètres) ainsi qu\'un test d\'attaque. Ajoutez le déplacement restant à vos __SN__, ou retirez une partie de vos __SN__ pour vous déplacer plus loin, puis attaquez."},"charger_repousser":{"major":1,"minor":1,"description":"Faites votre déplacement (au moins 5 mètres) ainsi qu\'un test d\'attaque. Ajoutez le déplacement restant à vos __SN__, ou retirez une partie de vos __SN__ pour vous déplacer plus loin, puis repoussez la cible de __SN__ (max FOR)."},"commander":{"major":1,"minor":0,"description":"Manoeuvrez un véhicule ou un drône."},"défense_totale":{"major":1,"minor":0,"reaction":true,"description":"Ajouter votre VOL à tous vos tests de défense jusqu\'à votre prochain tour."},"escalader":{"major":1,"minor":0,"description":"Faites un test d\'Athlétisme. Vous pouvez grimper 1m par __SN__."},"esquiver":{"major":0,"minor":1,"reaction":true,"description":"Ajouter votre Athlétisme à votre test de défense."},"feinte":{"major":0,"minor":1,"description":"Faites un test d\'Escroquerie pour distraire la cible. Tout le monde gagne __A1__ à ses action contre elle."},"intercepter":{"major":1,"minor":1,"reaction":true,"description":"Vous pouvez vous déplacer de REA mètres pour attaquer une cible à portée. Si vos __SN__ sont supérieurs à sa CON, elle est interrompue."},"intimider":{"major":1,"minor":0,"description":"Faites un test d\'Influence. Vous infligez Effrayé à la cible."},"lutter":{"major":1,"minor":0,"description":"Faites un test d\'Athlétisme pour maitriser un adversaire. En lutte, le défenseur se défend avec CON + FOR, et l\'attaquant attaque avec Combat rapproché."},"mettre_la_gomme":{"major":1,"minor":0,"description":"Doublez l\'accélération d\'un véhicule ou d\'un drône. (une fois par tour)"},"parcourir":{"major":2,"minor":0,"description":"Vous pouvez vous déplacer et escalader de 15m + 2 x __SN__. Les obstacles (<1,5m) et les sauts (<2m) ne comptent pas."},"protéger":{"major":0,"minor":1,"reaction":true,"description":"Vous pouvez vous déplacer de REA mètres pour prendre le coup à la place d\'une cible."},"risposter":{"major":0,"minor":1,"reaction":true,"description":"Subissez __D1__ sur votre test de défense. Si vous réussissez le test, vous rispostez et infligez __SN__ __DOM__ à votre attaquant."},"se_coucher":{"major":0,"minor":1,"description":"null"},"se_déplacer":{"major":0,"minor":1,"description":"Vous vous déplacez de 10m, une fois par tour."},"se_jeter_à_terre":{"major":0,"minor":1,"reaction":true,"description":"Vous obtenez 4d6 à votre test de défense, mais vous tombez à terre."},"se_mettre_à_couvert":{"major":0,"minor":1,"description":"null"},"se_relever":{"major":0,"minor":1,"description":"null"},"sprinter":{"major":1,"minor":0,"description":"Faites un test d\'Athlétisme. Vous pouvez vous déplacer de 15m + __SN__ et sauter les petits obstacles (<1m)."},"évitez_un_explosif":{"major":0,"minor":1,"reaction":true,"description":"Faites un test d\'Athlétisme + REA. Vous vous déplacez d\'1m par __SN__. Au delà de 2m, vous tombez à terre."}},"companions":{"Sprite_machine":{"name":"Sprite machine","stats_primary":{"major":1,"minor":4,"hit":"8 + P / 2"},"stats_secondary":{"attaque":1,"corruption":3,"firewall":0,"traitement":2},"skills":{"CwM1zqEuXU":"Electronique","MNeX9DFR2q":"Pilotage","w4z4wzsH43":"Ingenierie"},"actions":{"diagnostique":{"major":1,"minor":0,"maintained":true,"description":"Opère un monitoring de l\'appareil investi. Vous avez __A1__ lorsque vous utilisez l\'appareil."},"investir_un_appareil":{"major":1,"minor":0,"maintained":false,"description":"Le sprite occupe un appareil quelque soit le niveau d\'accréditation."},"stabilisation":{"major":1,"minor":0,"maintained":true,"description":"Surveille les dysfonctionnments de l\'appareil investi. Vous pouvez retirer jusqu\'à Serv. echecs à vos tests avec cet appareil."}}}}}';
